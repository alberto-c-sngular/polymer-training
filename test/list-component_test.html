<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, minimum-scale=1, initial-scale=1, user-scalable=yes">

    <title>list-component test</title>

    <script src="../../webcomponentsjs/webcomponents-loader.js"></script>
    <script src="../../web-component-tester/browser.js"></script>

    <link rel="import" href="../list-component.html">
  </head>
  <body>

    <test-fixture id="initialUserFixture">
      <template>
        <list-component></list-component>
      </template>
    </test-fixture>

    <test-fixture id="newUserFixture">
      <template>
        <list-component></list-component>
      </template>
    </test-fixture>

    <test-fixture id="backgroundsFixture">
        <template>
          <list-component></list-component>
        </template>
      </test-fixture>

    <script>

      suite('list-component', () => {
        let element1, element2, element3;
        
        setup(function() {
          element1 = fixture('initialUserFixture');
          element2 = fixture('newUserFixture');
          element3 = fixture('backgroundsFixture');
        });

        test('There is an initial user John Doe.', (done) => { 
          flush(function() {
            const elementShadowRoot = element1.shadowRoot;
            const rows = elementShadowRoot.querySelectorAll('tr');
            // Header + John Doe + new user row (input)
            assert.equal(rows.length, 3);
            done();
          });
          
        });

        test('Adding a new user increases the users array.', () => {
          const elementShadowRoot = element2.shadowRoot;
          element2.newName = 'Bruce';
          element2.newSurname = 'Wayne';
          element2.newAge = '45';
          const initialUsers = element2.users.length;
          element2.addUser();
          const finalUsers = element2.users.length;
          assert.equal(initialUsers + 1, finalUsers);
        });


        test('Background color depends on age', (done) => {
          // Child
          element3.newName = 'Kid';
          element3.newSurname = 'Flash';
          element3.newAge = '15';
          element3.addUser();

          flush(function() {
            const elementShadowRoot = element3.shadowRoot;
            const rows = elementShadowRoot.querySelectorAll('tr');
            assert.equal(rows[1].classList.contains('mature'), true);
            done();
          });
        });

      });
    </script>

  </body>
</html>
