<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-input/iron-input.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/iron-form/iron-form.html">

<dom-module id="new-person-form">
  <template>
    <style include="shared-styles">
      :host {
        display: block;              
      }

      .wrapper-btns {
        margin-top: 15px;
      }
    </style>

    <div class="person-wrapper">
      <h1>New person</h1>
      <iron-form id="myform">
        <form>          
          <paper-input 
            allowed-pattern="[a-zA-Z]"
            required
            error-message="This field is required" 
            id="name"
            label="Name"></paper-input>

          <paper-input 
            allowed-pattern="[a-zA-Z]"
            required
            error-message="This field is required" 
            id="lastname"
            label="Last name"></paper-input>

          <paper-input 
            allowed-pattern="[0-9]"
            required
            error-message="This field is required" 
            id="age"
            label="Age" type="text"></paper-input>
            
          <div class="wrapper-btns">
            <paper-button on-tap="addPerson" class="custom">Add person</paper-button>
          </div>
        </form>
      </iron-form>
      <br><br><hr>
    </div>

  </template>

  <script>
    class NewPersonForm extends Polymer.Element {
      static get is() { return 'new-person-form'; }

      addPerson(e) {
        let myForm = this.$.myform;
        if (myForm.validate()) {
          let person = {
            name: this.$.name.value,
            lastname: this.$.lastname.value,
            age: this.$.age.value
          }

          let addPersonButtonPressed = new CustomEvent('add-person-btn-pressed', { detail: { person: person }, bubbles: true, composed: true });
          this.dispatchEvent(addPersonButtonPressed);
          myForm.reset();
        }
      }
    }

    window.customElements.define(NewPersonForm.is, NewPersonForm);
  </script>
</dom-module>